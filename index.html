<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>C# to UnityScript converter by florentpoujol</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>C# to UnityScript converter</h1>
          <h2>An extension for the Unity3D engine</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/florentpoujol/CSharpToUnityScript/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/florentpoujol/CSharpToUnityScript/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/florentpoujol/CSharpToUnityScript" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">
          <h1>What does it do ?</h1>

<p>This extension for Unity3D does a damn good at converting C# scripts into UnityScript scripts.
More precisely, the extension provides a very good quality mass-conversion solution to translate C# code into UnityScript.</p>

<p>Current version : 1.0
Last edit of this manual on the 30th of November 2012.</p>

<h1>Contact</h1>

<p>florent dot poujol at gmail dot com
<a href="http://www.florent-poujol.fr/en">http://www.florent-poujol.fr/en</a>
My profile on Unity's forums : <a href="http://forum.unity3d.com/members/23148-Lion">http://forum.unity3d.com/members/23148-Lion</a></p>

<h1>How to buy</h1>

<p>You will be able to buy this extension from the offical Unity Asset Store and from GamePrefabs.com at some point during the first week of December 2012.</p>

<p>You want to try before bying ? No problem !
Head over to my website to <a href="http://www.florent-poujol.fr/en/unity3d/c-to-unityscript-converter">test the live demo</a>.
Unlike the extension, you can convert only 100 lives at a time but the quality of the conversion is identical !</p>

<h1>How to install</h1>

<p>Extract the CSharpToUnityScriptConverter.unitypackage in your Asset folder.
It will have created the "Assets/CSharpToUnityScript" folder.</p>

<p>Open the extension via the menu "Script Converters &gt; C# To UnityScript".</p>

<h1>How to use</h1>

<p>The extension will convert any C# scripts found in the "source" directory and create their UnityScript conterpart in the "target" directory.</p>

<p>By default, the source directory is "Assets/CSharpToUnityScript/Source" and the target directory will be "Assets/CSharpToUnityScript/ConvertedScripts". You may change these paths via the appropriate fields.</p>

<p>Put the C# scripts in your source directory then hit the "convert" button.
The extension tab shows you how many files are left to be converted.
The console display the name of the files when their conversion is completed.</p>

<p>If you have many files being converted and want to abord the conversion, just hit the "Abord" button.
This won't stops the conversion of the current file but it won't convert any more file after that.
If you hit the convert button again, it will convert again the whole source directory.</p>

<p>The conversion speed is about 10Ko or a couple hundreds of lines per second.</p>

<h1>Options</h1>

<p>You may choose if you want the converter to try to convert multiple inline variable declarations.
    // stuffs like :
    int var1, var2 = 2, var3, var4;</p>

<p>Despite all my efforts, the converter may still match a few false positive.
If you are confident that the code you want to convert does not contains such declarations, or only a few of them, you better leave the box unticked.</p>

<h1>Quality of the conversion</h1>

<p>Be advised that UnityScript has less features than C#.
That means that in some case, there is just no way to express in UnityScript what the C# does.</p>

<p>In some other cases, you will need to refactor part of the UnityScript code (when it's not done by the converter itself) to make it do the same thing as the C# code.</p>

<p>Finally, in some yet other cases, the conversion may not be performed, depending on the syntactic environnement.</p>

<h2>Take note of</h2>

<p>Casts without parenthesis around the casted expression stops at the first non alphanumeric character.</p>

<p>Multiple inline variable declaration will be messed up or won't be converted at all if a semi-colon is found anywhere whithin the whole delcaration, before the semi-colon that closes the expression.
Also having curly brackets and/or parenthesis inside values or instance may lead the expression not to be converted.</p>

<h1>Features not supported by UnityScript</h1>

<p>This sections shows which features does not work in UnityScript, and try to provide a work around when possible.</p>

<p>In some cases, the converter could deal with the situation itself, but it is just not (yet) implemented.</p>

<h2>Features dealt with by the converter</h2>

<ul>
<li>abstract keyword : abstract classes/methods are converted into regular classes/methods.</li>
<li>virtual keyword : it is just removed</li>
<li>Probably some others</li>
</ul><h2>Features that could be deal with by the converter (but that curently aren't)</h2>

<ul>
<li>You ca'nt have a method parameter nammed "get".</li>
<li>You can't create assembly aliases (using Alias=Assembly;)</li>
</ul><h2>Hopeless features</h2>

<p>The converter can not do anything about them, you have to deal with the situation yourself.</p>

<ul>
<li>Enums does not accepts negative values.</li>
<li>Static properties can't access another static property (you get the same error as if the accessed property is non-static).</li>
</ul><h3>Params keyword</h3>

<p>They are left, so they pop errors in the Unity console.
The solution is to remove the "params" keyword from the method declaration, then wrap the parameters in an array in the method call.</p>

<p>C# :</p>

<pre><code>void Method( params int[] values ) {}
Method( 1, 2 );
Method( 1, 2, 3 );

void Method( string firstParam, params int[] values ) {}
Method( "", 1, 2 );
Method( "", 1, 2, 3 );
</code></pre>

<p>UnityScript :</p>

<pre><code>function Method( values: int[] ) {}
Method( [1, 2] );
Method( [1, 2, 3] );

function Method( firestParam: String, values: int[] ) {}
Method( "", [1, 2] );
Method( "", [1, 2, 3] );
</code></pre>

<h2>Delegates and Events</h2>

<p>They does not exists in UnityScript but can be simulated to some extends.</p>

<p>You can't create custom-nammed delegate or callable types as in C# or Boo but you can express specific method signatures as Boo does :</p>

<p>C# :</p>

<pre><code>delegate string DelegateName(int arg);
DelegateName variabmeName = MethodName;
</code></pre>

<p>Boo :</p>

<pre><code>CallableName as callable(int) as string
variableName as CallableName = MethodName
</code></pre>

<p>UnityScript :</p>

<pre><code>// "Function" is a global callable type, that match any signatures. You should be able to use it wherever you use a delegate in C#
// But you can also be more specific :

function(int): String
function(String, boolean) // same as    function(String, boolean): void
var variableName: function(int): String = MethodName;
</code></pre>

<p>You also still have access to .Net's Action&lt;&gt; and Func&lt;&gt; generic delegates.</p>

<p>The converter convert every occurence of a delegate name to its US conterpart.
ie : Every occurence of "DelegateName" would be replaced by "function(int)"</p>

<p>Events does not exists, but they are just a specialized collection of method, something you can reproduce in UnityScript, while it require some code refactoring.</p>

<p>C# :</p>

<pre><code>delegate void FooBarSignature(int data);
// the event that will store the methods
event FooBarSignature foobarMethods;

[...]

// a method to be called when the event is thrown
void AMethod( int param ) {}

// registering methods
foobarMethods += AMethod;

// throwing an event
foobarMethods( 1 );
</code></pre>

<p>UnityScript :</p>

<pre><code>// the event can be simulated by any kind of list
var foobarMethodsList: List.&lt;function(int)&gt; = new List.&lt;function(int)&gt;();

function foorbarMethods( param: int ) {
    for (var method: function(int) in foobarMethodsList)
        method( param );
}

[...]

// a method to be called when the event is thrown
function AMethod( param: int ) {}

// registering methods, this is what you need to go over and change yourself
foobarMethodsList.Add( AMethod );

// throwing an event
foorbarMethods( 1 );
</code></pre>

<p>As of v1.0, nothing is done by the converter, everything is left untouched in the code.</p>

<h3>Arrays</h3>

<p>Single dimentionnal arrays should convert just fine.</p>

<p>The syntax of a multidimensionnal array in C#, becomes a jagged array in US :
C# :
    { {0}, {1} } // is of type int[,]
US :
    [ [0], [1] ] // is of type int[]<a href="same%20case%20in%20Boo"></a></p>

<p>Here is some examples of what works, what doesn't :</p>

<p>Jagged arrays :
    // syntax that does not work
    var jaggedArray: int[][];           =&gt;  display the error UCE0001: ';' expected. Insert a semicolon at the end.
    var jaggedArray = new int[1][2];    =&gt;  display the error : IndexOutOfRangeException: Array index is out of range.
    var jaggedArray = new int[2][1];    =&gt;  jaggedArray is of type int ...</p>

<p>Creating an empty two level jagged array is done like this :
    var jaggedArray = array.(10); // jaggedArray is of type int[][]  &lt;=&gt;  int[10][]
The declaration of variable with empty array setting is the only thing that is handled by the converter.
    Type[][] variable = new Type[num][];
    // is converted into
    var variable = array.(num);</p>

<p>But I don't know what is the equivalent of the expression "Type[][]" in UnityScript. So they are left in the code and pop errors.
You can also create a jagged array by setting its value right away :
    var array = [ [0], [1] ]; // array is of type int[][]</p>

<p>MultiDimentionnal arrays :
    var array: int[,];                  //  Works
    var array = new int[1,1];           //  Works
    var array: int[,] = new int[1,1];   //  Works</p>

<p>You can also use Boo's syntax :
    var array = matrix(int, 1, 1);
    var array: int[,] = matrix(int, 1, 1);</p>

<p>It seems that you can't set the value of a multidimentionnal array while declaring it.</p>

<h3>Out and Ref keywords</h3>

<p>In UnityScript, you don't need these keywords when you call a C# method (ie : the 'hitInfo' parameter of Physics.Raycast()).
But there is no way in UnityScript to create such behavior in the method declaration.
Remember that you can still use C# classes from UnityScript scripts if they (the C# scripts) are compiled first.</p>

<p>There are no easy way to pass a value type as reference in UnityScript but here is one hack : you can use an intermediary variable which contains the value.</p>

<p>C# :
    void RefMethod(ref int arg)
    {
        arg = 20;
    }</p>

<pre><code>void Start()
{
    int refVar = 5;

    RefMethod(ref refVar);

    Debug.Log(refVar); // will display 20
}
</code></pre>

<p>UnityScript :
    var ref = Array();</p>

<pre><code>function RefMethod()
{
    ref["refVar"] = 20;
}

function Start()
{
    var refVar = 5;

    ref["refvar"] = refVar;
    RefMethod();
    refVar = ref["refvar"];

    print(refVar); // will print 20
}
</code></pre>

<h1>Improving the conversion</h1>

<p>Sometimes, someting that convert just fine in most of the scripts will just not convert at all or be messed up in another script, for no apparent reason.
If that happens, please contact me (see section at the top) and give me your script if it's not top-secret.</p>

<p>Such behaviour is often du to a particular syntactic situation that makes the converter not recogize a pattern (or recogize when it shouldn't).
By gathering scripts where this happends, I may be able to find what triggers the situation.</p>
        </section>

        <footer>
          C# to UnityScript converter is maintained by <a href="https://github.com/florentpoujol">florentpoujol</a><br>
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="http://twitter.com/jasonlong">Jason Long</a>.
        </footer>

                  <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-9211759-15");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

      </div>
    </div>
  </body>
</html>